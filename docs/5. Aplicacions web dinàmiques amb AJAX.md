# Aplicacions web dinàmiques amb AJAX. Exemple d'una aplicació.

## Separació de la lògica de negoci.

Un dels principals objectius en el disseny d'aplicacions ha de ser la reutilització del codi. Per tal d'aconseguir-ho les aplicacions es divideixen en parts que es rel·lacionen entre si, però que també tenen sentit de forma independent.

A xicoteta escala, es creen funcions i classes. A nivel de disseny es pot crear una arquitectura amb varios components desacoblats que s'ocupen de parts diferents de l'aplicació.

En els exemples realitzats fins ara la lògica de negoci i la presentació estan barrejats. Per a millorar esta situació el primer pas seria separar l'eixida en funcions que se n'ocupen en exclusiva, i encara millor utilitzar una llibreria de plantilles.

Altra cosa que podriem fer és portar la lògica de la presentació al client (p.e: javascript), i així el client realitza peticions al servidor i mostra les dades rebudes.

AJAX és una tècnica de disseny d'aplicacions que es basa en fer peticions al servidor des de Javascript. En els capitols anterior l'eixida HTML es genera integrament en el servidor. En AJAX el servidor torna soles les dades que cal mostrar i el Javascript actualitza la pàgina segons les dades rebudes. D'esta manera desacoblem la lògica del negoci de la presentació i de rebot aconseguim:

* El codi és més fàcil de mantenir.
* El codi és pot reutilitzar en altres aplicacions (mòbils)
* Es pot treballar en les dues parts al mateix temps.

## Obtenció remota d'informació

Fins ara, s'ha vist que es sol·licita una pàgina al servidor quan:

* S'accedeix a una pàgina introduïnt una URL en el navegador.
* Al seguir un enllaç.
* A l'enviar un formulari.
* Com a conseqüència d'una redirecció.
 
En tots els casos, el navegador canvia el contingut que està mostrant amb la resposta que obtè del servidor, condicionant el disseny de les pàgines.

Es possible superar aquesta limitació utilitzant Javascript i AJAX. Per exemple, és possible que un script puga consultar noticies i mostrar-les sense haver de recarregar la pàgina.

L'element central d'AJAX és l'objecte XMLHttpRequest, que presenta una petició al servidor sense que la resposta es mostre automàticament com una nova pàgina en el navegador, sino que la processa el Javascript.

Les peticions poden ser síncrones o asíncrones i formen part del mòdul de Client.

## Resposta del servidor

Ara no respodrem amb una pàgina HTML sinó dades estructurades. Lo normal és utilitzar **JSON**

Per exemple:

~~~
<?php	
	$cat1 = array("cod" => 1, "nombre" => "Comida");
	$cat2 = array("cod" => 2, "nombre" => "Bebida");
	$array = array($cat1, $cat2);
	$json = json_encode($array);	
	echo $json;
~~~

torna:

~~~
[{"cod":1,"nombre":"Comida"},{"cod":2,"nombre":"Bebida"}]
~~~
 
 
 ## Utilitz
 